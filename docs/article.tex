% Copyright (c) 2010 Jérémie DECOCK (http://www.jdhp.org)

\documentclass[pdftex,a4paper,11pt]{article} 
%\documentclass[pdftex,a4paper,11pt]{report} 
\usepackage[utf8]{inputenc}
\usepackage[frenchb]{babel}
\usepackage[pdftex]{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{subfigure}
\usepackage{hyperref}

\hypersetup{
	pdftoolbar=true,                    % show Acrobat’s toolbar ?
	pdfmenubar=true,                    % show Acrobat’s menu ?
	pdffitwindow=true,                  % page fit to window when opened
	pdftitle={Pyarm},                   % title
	pdfauthor={Jérémie DECOCK},         % author
	pdfsubject={Pyarm},                 % subject of the document
	pdfnewwindow=true,                  % links in new window
	pdfkeywords={Pyarm},                % list of keywords
	colorlinks=true,                    % false: boxed links; true: colored links
	linkcolor=black,                    % color of internal links
	citecolor=black,                    % color of links to bibliography
	filecolor=black,                    % color of file links
	urlcolor=black                      % color of external links
}

%\newcommand{\reels}{\mathbb{R}}

\begin{document}

\title{Pyarm}
\author{
	Jérémie \bsc{Decock}
}
\date{\today{}}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Présentation des modèles}

\subsection{Présentation}

\begin{center}
        \includegraphics[width=.40\linewidth]{fig/arm}
\end{center}

\begin{itemize}
    \item Bras 2D
    \item Plan horizontal (Mitrovic, Weiwei) ou vertical (Kambara)
    \item 2 membres (le bras et l'avant-bras) % ou arrière-bras ou bras supérieur
    \item 2 articulations (épaule et coude)
    \item 6 muscles~:
    \begin{enumerate}
        \item fléchisseur de l'épaule
        \item extenseur de l'épaule
        \item fléchisseur du coude
        \item extenseur du coude
        \item fléchisseur
        \item extenseur
    \end{enumerate}
\end{itemize}

Remarque : la numérotation des muscles est différente dans le modèle de Weiwei.

\subsection{Les modèles étudiés}
Trois modèles ont été étudiés~:
\begin{itemize}
    \item Katayama / Mitrovic \cite{katayama1993, ozkaya1999, mitrovic10, mitrovic2008, mitrovic2009}
    \item Kambara \cite{kambara2009, ozkaya1999}
    \item Brown / Weiwei \cite{brown1999, li2006, li2004, todorov2005}
\end{itemize}

%\cite{mitrovic10}
%\cite{mitrovic2008}
%\cite{mitrovic2009}
%\cite{katayama1993}
%\cite{brown1999}
%\cite{li2006}
%\cite{li2004}
%\cite{todorov2005}

\subsection{Historique}

\begin{center}
        \includegraphics[width=.80\linewidth]{fig/bib}
\end{center}

\subsection{Simulateur Pyarm}

\begin{itemize}
    \item Codé en Python
    \item Implémente les 3 modèles
\end{itemize}

%\begin{center}
%    \includegraphics[width=.40\linewidth]{fig/pyarm1}
%\end{center}
\begin{figure}
    \centering
    \subfigure{\includegraphics[width=.50\linewidth]{fig/pyarm2}}~~~
    \subfigure{\includegraphics[width=.50\linewidth]{fig/pyarm3}}~~~
\end{figure}

\paragraph{}
Le simulateur est composé de 5 modules :
\begin{itemize}
    \item Filtre sur signal d'entrée
    \item Modèle de bras
    \begin{itemize}
        \item Cinématique
        \item Dynamique
    \end{itemize}
    \item Modèle de muscle
    \begin{itemize}
        \item Cinématique inverse
        \item Dynamique
    \end{itemize}
\end{itemize}

\paragraph{}
\begin{center}
        \includegraphics[width=.60\linewidth]{fig/modules}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Cinematique inverse du muscle}

\subsection{Methode d'Euler}

\begin{tabular}{lcl}
    $l$       & = & $l_m - A q $ \\
    $\dot{l}$ & = & $\frac{\delta l}{\delta t}$ \\
    $l_{m}$   & = & Longueur du muscle $i$ au repos pour l'angle $q = 0$ \\
\end{tabular}
    
\begin{center}
        \includegraphics[width=.50\linewidth]{fig/moment_arm}
\end{center}

% TODO
Dans les modèles de Mitrovic et Kambara, la longueur du bras d'inertie est constante. Elle correspond au rayon ...
Sous réserve que la longueur de l'arc soit toujours positive (...)
% TODO

\begin{center}
        \includegraphics[width=.50\linewidth]{fig/muscle_length}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Dynamique du muscle}

\subsection{Mitrovic}

\begin{tabular}{lcl}
    $\tau$ & = & $-A^T t(l, \dot{l}, u)$ \\
    \\
    $t(l, \dot{l}, u)$        & = & $k(u) (l_r(u) - l) + b(u) \dot{l}$ \\
    \\
    $k(u)$    & = & $k_0 + k u$ \\
    $b(u)$    & = & $b_0 + b u$ \\
    $l_r(u)$  & = & $l_0 - r u$ \\
    \\
%    $l$       & = & $l_m - A q $ \\
%    $\dot{l}$ & = & $l_m - A \dot{q} $ \\
\end{tabular}

\paragraph{}
\begin{tabular}{lcl}
    $\tau_i$ & = & Couple total exercé sur l'articulation $i$ \\
    $A$  & = & Matrice des bras de levier \\
    $t(l, \dot{l}, u)$  & = & Tension exercée par le muscle \\
    $k(u)$ & = & Raideur du muscle \\
    $b(u)$ & = & Viscosité du muscle \\
    $l_r(u)$ & = & Longueur du muscle au repos \\
    $l$ & = & Longueur du muscle \\
    $u$ & = & Signaux d'activation du muscle \\
    $k_0$ & = & Élasticité intrinsèque \\
    $b_0$ & = & Viscosité intrinsèque \\
    $l_0$ & = & Longueur du muscle au repos \\
    $k$ & = & Coefficient de variation de l'élasticité \\
    $b$ & = & Coefficient de variation de la viscosité \\
    $r$ & = & Coefficient de variation de la longueur au repos \\
    %$l_{0i}$ & = & Longueur du muscle au repos pour l'angle $q = 0$ \\
\end{tabular}

%%%%%%%%

\subsection{Kambara}

\begin{tabular}{lcl}
    $\tau$ & = & $A^T T$ \\
    \\
    $T_i$                     & = & $K_i(\tilde{u}_i) (L_i - L_i^{rest}(\tilde{u}_i)) + B_i(\tilde{u}_i) \dot{L}_i$ \\
    \\
    $K_i(\tilde{u}_i)$        & = & $k_{0i} + k_{1i} \tilde{u}_i$ \\
    $B_i(\tilde{u}_i)$        & = & $b_{0i} + b_{1i} \tilde{u}_i$ \\
    $L_i^{rest}(\tilde{u}_i)$ & = & $ l_{0i}^{rest} - l_{1i}^{rest} \tilde{u}_i$ \\
    %\\
    %$L_i$ & = & $l_{0i} - \sum_{j=1}^2 A_{i,j} q_j $ \\
\end{tabular}

\paragraph{}
\begin{tabular}{lcl}
    $\tau_i$ & = & Couple total exercé sur l'articulation $i$ \\
    $A$  & = & Matrice des bras de levier \\
    $T_i$  & = & Tension exercée par le muscle $i$ \\
    $K_i(\tilde{u}_i)$ & = & Raideur du muscle $i$ \\
    $B_i(\tilde{u}_i)$ & = & Viscosité du muscle $i$ \\
    $L_i^{rest}(\tilde{u}_i)$ & = & Longueur du muscle $i$ au repos \\
    $L_i$ & = & Longueur du muscle $i$ \\
    $\tilde{u}_i$ & = & Signaux d'activation filtrés du muscle $i$ \\
    $k_{0i}$ & = & Élasticité intrinsèque \\
    $b_{0i}$ & = & Viscosité intrinsèque \\
    $l^{rest}_{0i}$ & = & Longueur du muscle $i$ au repos \\
    $k_{1i}$ & = & Coefficient de variation de l'élasticité \\
    $b_{1i}$ & = & Coefficient de variation de la viscosité \\
    $l^{rest}_{1i}$ & = & Coefficient de variation de la longueur au repos \\
    $l_{0i}$ & = & Longueur du muscle $i$ au repos pour l'angle $q = 0$ \\
\end{tabular}

%%%%%%%%

\subsection{Weiwei}

\begin{center}
        \includegraphics[width=.40\linewidth]{fig/brown}
\end{center}

\begin{tabular}{lcl}
    $CE$  & = & éléments contractiles \\
    $SE$  & = & élasticité des tendons (ignorée) \\
    $PE$  & = & élasticité du muscle \\
    $PE1$ & = & résistance à l'étirement du muscle passif \\
    $PE2$ & = & résistance à la compression du muscle actif \\
\end{tabular}

\paragraph{}
\begin{tabular}{lcl}
    $\tau$ & = & $M(q) T(a, l(q), v(q, \dot{q}))$ \\
    \\
    $T(a, l, v)$ & = & $A(a,l)(F_L(l) F_V(l,v) + F_P(l))$ \\
    $A(a, l)$    & = & $1 - \exp \left(- \left(\frac{a}{0.56 N_f(l)}\right)^{N_f(l)}\right)$ \\
    $N_f(l)$     & = & $2.11 + 4.16 \left(\frac{1}{l} - 1\right)$ \\
    $F_L(l)$     & = & $\exp \left(-\left|\frac{l^{1.93} - 1}{1.03}\right|^{1.87}\right)$ \\
    $F_V(l, v)$  & = & $\left\{ 
        \begin{array}{l}
            \frac{-5.72 - v}{-5.72 + (1.38 + 2.09 l) v}, v \leq 0 \\
            \frac{0.62 - \left(-3.12 + 4.21 l - 2.67 l^2\right) v}{0.62 + v}, v > 0 \\
        \end{array}
        \right.$ \\
    $F_P(l)$     & = & $-0.02 \exp(13.8 - 18.7 l)$ \\
\end{tabular}

\paragraph{}
\begin{tabular}{lcl}
    $M(q)$  & = & matrice des bras de levier $(a + b \cos (c q))$ \\
    $T(a, l, v)$ & = & tension exercée par le muscle \\
    $A(a, l)$    & = & relation activation-fréquence \\
%    $N_f(l)$     & = &  \\
    $F_L(l)$     & = & relation force-longueur \\
    $F_V(l, v)$  & = & relation force-vitesse \\
    $F_P(l)$     & = & force élastique du muscle \\ % TODO ???
    $a$          & = & signaux d'activation filtrés du muscle \\
    $l$          & = & longueur du muscle \\
    $v$          & = & vitesse de contraction du muscle \\
\end{tabular}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Modèle du bras}

%%%%%%%%

\subsection{Cas général}

\subsubsection{Dynamique inverse}
$\tau = M(q)\ddot{q} + C(q, \dot{q}) + B(\dot{q}) + G(q) $ \emph{(1)}

\subsubsection{Dynamique}
\emph{(1)} $\Leftrightarrow \ddot{q} = M(q)^{-1} (\tau - C(q, \dot{q}) - B(\dot{q}) - G(q)) $

\subsubsection{Légende}
\begin{tabular}{lcl}
    $M \in \mathbb{R}^{2 \times 2}$  & = & matrice des moments d'inertie \\ % TODO
    $C \in \mathbb{R}^{2}$  & = & force de Coriolis et force centripète \\
    $B \in \mathbb{R}^{2}$  & = & force de viscosité et de friction \\ % TODO
    $G \in \mathbb{R}^{2}$  & = & force de gravité \\
    $\tau \in \mathbb{R}^{2}$        & = & couple total exercé sur les articulations ($N \cdot m$) \\
    $\ddot{q} \in \mathbb{R}^{2}$    & = & accélération angulaire ($rd \cdot s^{-2}$) \\
    $\dot{q} \in \mathbb{R}^{2}$     & = & vitesse angulaire ($rd \cdot s^{-1}$)\\
    $q \in \mathbb{R}^{2}$           & = & angle ($rd$)\\
\end{tabular}

\paragraph{}
\begin{tabular}{lcl}
    $m_i$ & = & masse du membre $i$ \\
    $l_i$ & = & longueur du membre $i$ \\
    $\gamma_i$ & = & distance séparant le centre de l'articulation au centre de masse du membre $i$ \\
    $\iota_j$ & = & moment d'inertie de l'articulation $j$ \\
    $\hat{g}$ & = & champ de pesanteur \\
\end{tabular}

\paragraph{}
%Indices :\\
\begin{tabular}{lcl}
    $u$ & = & bras (supérieur)\\
    $f$ & = & avant-bras\\
    $s$ & = & épaule\\
    $e$ & = & coude\\
\end{tabular}

%%%%%%%%

\subsection{Mitrovic}

\subsubsection{Dynamique inverse}
$\tau = M(q)\ddot{q} + C(q, \dot{q}) \dot{q}$

\paragraph{}
\begin{tabular}{lcl}
    $M$ & = &
    $
    \begin{pmatrix}
        \iota_s + \iota_e + m_f l_u^2 + 2 m_f l_u \gamma_f \cos(q_e)  &  \iota_e + m_f l_u \gamma_f \cos(q_e) \\
        \iota_e + m_f l_u \gamma_f \cos(q_e)  &  \iota_e\\
    \end{pmatrix}
    $ \\

    $C$ & = &
    $
    \begin{pmatrix}
        -2 \dot{q}_e  &  -\dot{q}_e \\
        \dot{q}_s     &  0\\
    \end{pmatrix}
    m_f l_u \gamma_f \sin(q_e)
    $\\
\end{tabular}

\subsubsection{Dynamique}
$\ddot{q} = M(q)^{-1} (\tau - C(q, \dot{q}) \dot{q}) $

%%%%%%%%

\subsection{Kambara}

\subsubsection{Dynamique inverse}
$
\begin{pmatrix}
    \tau_1 \\
    \tau_2 \\
\end{pmatrix}
=
\begin{pmatrix}
    M_{11}\ddot{q}_1 + M_{12}\ddot{q}_2 + h_{122}\dot{q}_2^2 + 2h_{112}\dot{q}_1\dot{q}_2 + G_1 \\
    M_{21}\ddot{q}_1 + M_{22}\ddot{q}_2 + h_{211}\dot{q}_1^2 + G_2 \\
\end{pmatrix}
$
\emph{(3)}

\paragraph{}
\begin{tabular}{lcl}
    $M_{11}$ & = & $\iota_s + \iota_e + m_f(l_u^2 + 2 l_u \gamma_f \cos(q_e)$) \\
    $M_{12}$ & = & $\iota_e + m_f l_u \gamma_f \cos(q_e)$ \\
    $M_{21}$ & = & $\iota_e + m_f l_u \gamma_f \cos(q_e)$ \\
    $M_{22}$ & = & $\iota_e$ \\
    $h_{122}$ & = & $-m_f l_u \gamma_f \sin(q_e)$ \\
    $h_{112}$ & = & $-m_f l_u \gamma_f \sin(q_e)$ \\
    $h_{211}$ & = & $m_f l_u  \gamma_f \sin(q_e)$ \\
    $G_1$ & = & $m_u \hat{g}  \gamma_u \cos(q_s) + m_f \hat{g} (l_u \cos(q_s) + \gamma_f \cos(q_s + q_e))$ \\
    $G_2$ & = & $m_f \hat{g}  \gamma_f \cos(q_s + q_e))$ \\
\end{tabular}

\paragraph{}
\begin{tabular}{lcl}
    \emph{(3)} & $\Leftrightarrow$ & $\tau = M(q)\ddot{q} + C(q, \dot{q}) \dot{q} + g$ \\
\end{tabular}

\subsubsection{Dynamique}
\emph{(3)} $\Leftrightarrow \ddot{q} = M(q)^{-1} (\tau - C(q, \dot{q}) \dot{q} - g) $

%%%%%%%%

\subsection{Weiwei}

\subsubsection{Dynamique inverse}
$\tau = M(q)\ddot{q} + C(q, \dot{q}) + B\dot{q} $ \emph{(4)}

\paragraph{}
\begin{tabular}{lcl}
    $M$ & = &
    $
    \begin{pmatrix}
        d_1 + 2 d_2 \cos(q_e)  & d_3 + d_2 \cos(q_e) \\
        d_3 + d_2 \cos(q_e) & d_3 \\
    \end{pmatrix}
    $ \\

    $C$ & = &
    $
    \begin{pmatrix}
        -\dot{q}_e (2 \dot{q}_s + \dot{q}_e) \\
        \dot{q}_s^2 \\
    \end{pmatrix}
    d_2 \sin(q_e)
    $\\

    $B$ & = &
    $
    \begin{pmatrix}
        0.05  & 0.025 \\
        0.025 & 0.05 \\
    \end{pmatrix}
    $
\end{tabular}

\paragraph{}
\begin{tabular}{lcl}
    $d_1$ & = & $\iota_s + \iota_e + m_f l_u^2$ \\
    $d_2$ & = & $m_f l_u \gamma_f$ \\
    $d_3$ & = & $\iota_e$ \\
\end{tabular}

\subsubsection{Dynamique}
\emph{(4)} $\Leftrightarrow \ddot{q} = M(q)^{-1} (\tau - C(q, \dot{q}) - B\dot{q}) $

\subsection{Résumé}
\begin{tabular}{|c|l|}
    \hline
    Mitrovic & $\ddot{q} = M(q)^{-1} (\tau - C(q, \dot{q}) \dot{q})$ \\
    \hline
    Kambara  & $\ddot{q} = M(q)^{-1} (\tau - C(q, \dot{q}) \dot{q} - G)$ \\
    \hline
    Weiwei   & $\ddot{q} = M(q)^{-1} (\tau - C(q, \dot{q}) - B\dot{q})$ \\
    \hline
\end{tabular}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Cinematique du bras}

\subsection{Methode d'Euler}

\begin{tabular}{lcl}
    $\dot{q}$ & = & $\delta \ddot{q} \cdot \delta t$ \\
    $q$ & = & $\delta \dot{q} \cdot \delta t$ \\
\end{tabular}
    
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Bibliographie}

%\cite{clef_de_référence}

\bibliographystyle{plain}
\bibliography{article}

\end{document}
